jira_policy_enabled=1
demil="-";
output=""
finalRegex="";
projectFileName=`pwd`"/.git/hooks/projectName.txt";
createRegex() {
        output=".*"
       # if [[ $1 == *$demil* ]]
        #then
          split=`echo $1 | cut -d "-" -f1 `;
          output=$output$split-[0-9]+;
        #else
	 # echo "$projectFileName is not formatted correctly, please mention all the projects in seperate line"
          #return -1;
        #fi
}

getRegex(){
	for var in "$@"
	do
  		if test -f "$var" ;then
        		while read -r line || [[ -n "$line" ]]; do
                	createRegex $line;
                	finalRegex=$finalRegex$output"|";
                	output="";
        	done < "$var"
        	break;
  	else
        	createRegex $var
  	fi
done

if [ ${#finalRegex} -gt 0 ];then
	finalRegex=${finalRegex:0:${#finalRegex}-1}
else
	echo "projectName.txt does not contain any jira project id.\nPlease add the project"
	exit -1;
fi
}
run_commit_msg_format_policy()
{
 getRegex $projectFileName
# echo "regular expression is $finalRegex"
 if egrep -q "$finalRegex" $1; then
 return 0
 else
 echo "[POLICY] Your message is not formatted correctly, please mention a jira ticket id, eg  WT-99"
 exit -1
 fi
}
if [ $jira_policy_enabled -eq 1 ]; then
 run_commit_msg_format_policy $1
fi

